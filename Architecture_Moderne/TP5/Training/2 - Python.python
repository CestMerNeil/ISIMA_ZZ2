{"version":"NotebookV1","origId":2196225004912872,"name":"2 - Python","language":"python","commands":[{"version":"CommandV1","origId":2196225004912873,"guid":"a6279de5-f1fd-479e-ba0a-1c08515fd6ef","subtype":"command","commandType":"auto","position":0.25,"command":"%md ## Let's switch to Python to transform the data\n\nLet's create a Path and a movies variable to store the path of the CSV file and create a dataframe movies\n\nUse the following command to create a dataframe\n`spark.read.option(\"header\",True).csv(path)`","commandVersion":96,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"303bb339-d7f1-4e16-b156-970bc2f207cd"},{"version":"CommandV1","origId":2196225004912874,"guid":"2705ba1b-b8c2-470f-bd4a-b8cc237ce1d3","subtype":"command","commandType":"auto","position":0.375,"command":"# STEP 1\n\npath = \"???\"\nmovies ???","commandVersion":25,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"f4536257-d3c7-47e9-89b4-9bd76d2ee13e"},{"version":"CommandV1","origId":2196225004912875,"guid":"daacfd24-34a3-4a5a-9f62-23ebd9b81865","subtype":"command","commandType":"auto","position":0.5,"command":"# STEP 1 Solution\n\npath = \"dbfs:/FileStore/shared_uploads/YOUR_EMAIL_ADDRESS/disney_plus_titles.csv\"\nmovies = spark.read.option(\"header\",True).csv(path)\n","commandVersion":50,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":true,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"8bf51bf0-ac00-4c67-adf1-3aaf20076b72"},{"version":"CommandV1","origId":2196225004912876,"guid":"9c8f4a58-93bc-4c4e-8cd1-4db5ac5ad27f","subtype":"command","commandType":"auto","position":0.75,"command":"%md \nUse de `display` method to show the content of the DataFrame.\n\nDisplay the Data Profile result to analyse the content and quality of the different columns\n\nWhat is the column with the higher number of null values ?","commandVersion":79,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"be7e4f80-c804-4257-9823-6a1d2852f53c"},{"version":"CommandV1","origId":2196225004912877,"guid":"3c7f1f5e-7e2e-42bd-8440-acaf01aca249","subtype":"command","commandType":"auto","position":0.875,"command":"# STEP 2\n\n# CODE HERE","commandVersion":11,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"4274","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"d48df37b-c7cc-44c3-b95a-f9fdfb63204c"},{"version":"CommandV1","origId":2196225004912878,"guid":"cd69afbc-25bb-4fa0-b972-7c0ddec98e94","subtype":"command","commandType":"auto","position":1.0,"command":"#STEP 2 SOLUTION\n\ndisplay(movies)\n## result is director's colmmn","commandVersion":32,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"4289","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":true,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"60effe16-a2e9-4b12-9e74-ed0ad61a128c"},{"version":"CommandV1","origId":2196225004912879,"guid":"da33e394-144c-484d-81b3-9de42f660a9c","subtype":"command","commandType":"auto","position":1.5,"command":"%md \n## Let's DROP some columns\n\nDo some data cleaning and drop the column country, date_added, description\n\nDocumentation here: https://spark.apache.org/docs/latest/api/python/reference/api/pyspark.sql.DataFrame.html#pyspark.sql.DataFrame","commandVersion":34,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"7f272140-62ee-4200-87ca-f5bbb97a19da"},{"version":"CommandV1","origId":2196225004912880,"guid":"67e86126-f45d-46cc-a139-e65f192f4289","subtype":"command","commandType":"auto","position":1.75,"command":"# STEP 3\n\n# CODE HERE\nmovies = \nmovies =\nmovies = \ndisplay(movies)","commandVersion":20,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"dc1318d6-9ce2-47d9-b0be-cff33cc72a34"},{"version":"CommandV1","origId":2196225004912881,"guid":"77e888db-71be-4015-8794-7c81749b98ee","subtype":"command","commandType":"auto","position":2.0,"command":"# STEP 3 SOLUTION\n\nmovies = movies.drop(\"country\")\nmovies = movies.drop(\"date_added\")\nmovies = movies.drop(\"description\")\n\ndisplay(movies)","commandVersion":90,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"3738","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":true,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"fa09cde7-f1ab-43c7-9483-cbf0d1ea4a7f"},{"version":"CommandV1","origId":2196225004912882,"guid":"8fbe3837-579f-4df6-91e5-64113718ea69","subtype":"command","commandType":"auto","position":2.5,"command":"%md \n## Then split the data in a column\n\nUsing the split function only select the first director, drop the column and introduce a new column `director 1`\n\nhttps://spark.apache.org/docs/2.2.0/api/python/pyspark.sql.html#pyspark.sql.functions.split\n\nhttps://spark.apache.org/docs/latest/api/python/reference/api/pyspark.sql.DataFrame.withColumn.html","commandVersion":49,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"b5262cf8-cb9c-429d-9851-071a1687efe1"},{"version":"CommandV1","origId":2196225004912883,"guid":"ffa31377-3b58-4e26-96db-e80778563e19","subtype":"command","commandType":"auto","position":2.5625,"command":"# STEP 4\n\nfrom pyspark.sql.functions import split\n\n#create a variable to store the first director\nsplit_col = split(movies['???'], ',')\n\n#use this variable to add a new colum main_director to the dataframe\n??? = movies.???('???', split_col.getItem(0))\n\n# drop director column\n???\n\ndisplay(movies)\n\n","commandVersion":72,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"9e2058e2-c5bc-4f4e-81bb-b0d61f3966de"},{"version":"CommandV1","origId":2196225004912884,"guid":"53cc449e-f105-4827-94df-fc3ecb4aa3f3","subtype":"command","commandType":"auto","position":3.0,"command":"# STEP 4 SOLUTION\n\nfrom pyspark.sql.functions import split\n\nsplit_col = split(movies['director'], ',')\n\nmovies = movies.withColumn('main_director', split_col.getItem(0))\nmovies = movies.drop(\"director\")\n\ndisplay(movies)\n","commandVersion":37,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"4101","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":true,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"45ff3f52-bb09-4f68-b1fc-47c1218056f6"},{"version":"CommandV1","origId":2196225004912885,"guid":"fab9e92c-cb35-49a4-9d3f-d3d5cdfe0208","subtype":"command","commandType":"auto","position":3.5,"command":"%md \n\n## Then create an aggregated dataFrame\n\nUsing the `group by`  and `agg` method, create a new dataframe \"ry\" with the number of movies per release_year \n\nDocumentation: https://spark.apache.org/docs/latest/api/python/reference/api/pyspark.sql.DataFrame.html#pyspark.sql.DataFrame\n\nDisplay the result in a graph","commandVersion":117,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"e4af6df0-b73e-4060-b771-56358b34a314"},{"version":"CommandV1","origId":2196225004912886,"guid":"944deb85-af51-45ef-a1d0-6c7be6db75cb","subtype":"command","commandType":"auto","position":3.75,"command":"# STEP 5\n\nfrom pyspark.sql.functions import count\n\n# Count the number of movies per year and store it in \"ry\"\n??? = movies.groupBy(\"???\").???(count('release_year').alias(\"c\"))\n\n# order the columns\nry = ry.???(ry.c.desc())\n\n# Display ry\n\n\n","commandVersion":66,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"276","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"0df83249-9f4f-4706-a142-d3930b009b45"},{"version":"CommandV1","origId":2196225004912887,"guid":"f0d9ee25-c093-443b-ac44-9fb4fa631793","subtype":"command","commandType":"auto","position":4.0,"command":"# STEP 5 SOLUTION\nfrom pyspark.sql.functions import count\n\n# Count the number of movies per year and store it in \"ry\"\nry = movies.groupBy(\"release_year\").agg(count('release_year').alias(\"c\"))\n\n# order the columns\nry = ry.orderBy(ry.c.desc())\n\n# Display ry\ndisplay(ry)","commandVersion":101,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"plotlyBar","width":"660","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":true,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"66999e05-a29c-4dbf-a87e-c242150184da"},{"version":"CommandV1","origId":2196225004912888,"guid":"f1cb0e4c-7522-43eb-a0f9-f2c9e1940119","subtype":"command","commandType":"auto","position":4.25,"command":"%md \n## And finish by saving a dataframe into a Delta file\n\nSave the file as Delta file in your user directory under `disney`\n\n`dataframe.write.format(\"delta\").save(PATH)`","commandVersion":64,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"a47a4de2-ef1c-4c7d-9fc0-adad97922037"},{"version":"CommandV1","origId":2196225004912889,"guid":"4176b36c-1690-4d80-88c7-cdb1a407c9fd","subtype":"command","commandType":"auto","position":4.375,"command":"# STEP 6 \n\n# let's restart from the beginning to ensure we are all at the same page :)\n\npath = \"dbfs:/FileStore/shared_uploads/YOUR_EMAIL_ADDRESS/disney\"\nmovies = spark.read.option(\"header\", True).csv(path)\nmovies = movies.drop(\"country\")\nmovies = movies.drop(\"date_added\")\nmovies = movies.drop(\"description\")\nmovies = movies.drop(\"director\")\n\n\n# Save the Delta file\n???","commandVersion":100,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"ae269285-c4cd-4750-9243-f93b6ecc7b6f"},{"version":"CommandV1","origId":2196225004912890,"guid":"de0c8791-d86b-42c6-b14a-0dddf2eb41db","subtype":"command","commandType":"auto","position":4.625,"command":"# STEP 6 SOLUTION\n\n# let's restart from the beginning to ensure we are all at the same page :)\n####### CHANGE USER ID #######\n\n#dbutils.fs.rm(\"adl://cdlprdadlsweu.azuredatalakestore.net/50_user/F289632/disney\", True)\npath = \"dbfs:/FileStore/shared_uploads/YOUR_EMAIL_ADDRESS/disney\"\nmovies = spark.read.option(\"header\", True).csv(path)\nmovies = movies.drop(\"country\")\nmovies = movies.drop(\"date_added\")\nmovies = movies.drop(\"description\")\nmovies = movies.drop(\"director\")\n\n\nhome_path = \"dbfs:/FileStore/shared_uploads/YOUR_EMAIL_ADDRESS/disney\"\n# Save the Delta file\nmovies.write.format(\"delta\").save(home_path)","commandVersion":61,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":true,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"fe205e3d-a4be-4f39-a137-a8337ab2427f"}],"dashboards":[],"guid":"ce3d3fba-4071-4210-8d6f-389ee68527a8","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":2}}