{"version":"NotebookV1","origId":2196225004912891,"name":"3 - Delta","language":"sql","commands":[{"version":"CommandV1","origId":2196225004912892,"guid":"a1ce55f1-d097-4124-9309-8de1e0372e07","subtype":"command","commandType":"auto","position":0.40625,"command":"%md \n## We first need a database\n\nCreate an empty database on the databriks cluster \n\nPlease use your ID as the name to simplify cleanup :)\n\nAnd make it your current database for yout notebook\n","commandVersion":109,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"0b538322-0463-4ad0-b7f7-a4d38da2a892"},{"version":"CommandV1","origId":2196225004912893,"guid":"369755f3-fd0e-43ac-92db-0cf66e9ae8e1","subtype":"command","commandType":"auto","position":0.609375,"command":"-- STEP 1\n\n%sql \n\nCREATE DATABASE ???\nUSE ???","commandVersion":43,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"47896638-8003-4a9b-b008-1609f72161d2"},{"version":"CommandV1","origId":2196225004912894,"guid":"7d5d73bc-4f2a-4f85-989b-352d2d2ceceb","subtype":"command","commandType":"auto","position":0.8125,"command":"-- STEP 1 SOLUTION\n------------   Change the USER_ID ----------\n--DROP TABLE movies;\n--DROP DATABASE if exists F289632;\nCREATE DATABASE if not exists Movies;\nUSE Movies;","commandVersion":174,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":true,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"f28e55ee-3809-4e90-9c0b-783435c5fc79"},{"version":"CommandV1","origId":2196225004912895,"guid":"c875c040-54f0-403d-a991-1c296243ce77","subtype":"command","commandType":"auto","position":0.859375,"command":"%md \n## Create the table \n\nCreate a Delta table in the database using the files created on the previous exercice and stored on your ADLS\n\nNavigate to your database and see that the table has been created\n\nAdd CDC to this table we will use this property later ( in Notebook 4)","commandVersion":91,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"a8f854e9-685e-4ffb-b8d0-9990c93af7ce"},{"version":"CommandV1","origId":2196225004912896,"guid":"543af869-81ab-47c3-aeb2-bb38dc030709","subtype":"command","commandType":"auto","position":0.8671875,"command":"-- STEP 2 \n\nCREATE TABLE movies USING DELTA location '???';\n","commandVersion":22,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"30be7146-d12d-4ae4-bfc4-8cfa6c4b60ab"},{"version":"CommandV1","origId":2196225004912897,"guid":"c120a800-a437-471b-aa8f-e0b344eba1b1","subtype":"command","commandType":"auto","position":0.875,"command":"-- STEP 2 Solution\n------------ CHANGE USER ID ------------\nDROP TABLE if exists movies;\n\nCREATE TABLE  IF NOT EXISTS movies USING DELTA location 'dbfs:/FileStore/shared_uploads/YOUR_EMAIL_ADDRESS/disney';\n\nALTER TABLE movies SET TBLPROPERTIES (delta.enableChangeDataCapture = true)","commandVersion":104,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":true,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"fb39190a-ba57-441b-8d0c-1354a98ea594"},{"version":"CommandV1","origId":2196225004912898,"guid":"9e5e7439-7a1e-4cd9-86a3-51510b307d65","subtype":"command","commandType":"auto","position":0.90625,"command":"%md You can now run a `select *` on the table ","commandVersion":54,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"638910d5-d1fd-4fb3-ac35-e88d3925582d"},{"version":"CommandV1","origId":2196225004912899,"guid":"7866f0c3-e945-4fc4-a454-c2561ff58289","subtype":"command","commandType":"auto","position":0.921875,"command":"-- STEP 3\n\n-- CODE HERE\n","commandVersion":19,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"1efb1478-6b48-4281-82a9-6266df2dd472"},{"version":"CommandV1","origId":2196225004912900,"guid":"8ea78881-f74d-4769-8a7d-c039aad724d2","subtype":"command","commandType":"auto","position":0.9375,"command":"-- STEP 3 Solution\n\nSELECT * FROM movies;\n","commandVersion":33,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"4274","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":true,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"06dd4a20-cf41-49eb-b570-3c2d9cee442b"},{"version":"CommandV1","origId":2196225004912901,"guid":"39f487eb-da39-4f92-8a58-8189b72a54c7","subtype":"command","commandType":"auto","position":0.94140625,"command":"%md\n## With Delta format you will be able to access the history of the table\n\nYou can also use the command \"DESCRIBE HISTORY\" to see the different operations that took place on the table","commandVersion":57,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"ebf784a5-382e-4b5c-afc6-b3313dc01b9e"},{"version":"CommandV1","origId":2196225004912902,"guid":"28f0d706-01ee-48d8-8beb-949793b19aa3","subtype":"command","commandType":"auto","position":0.943359375,"command":"-- STEP 4 \n\n-- CODE HERE","commandVersion":8,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"17b73634-d261-41e5-9e65-57cfa3d5139e"},{"version":"CommandV1","origId":2196225004912903,"guid":"bb2fb65e-796f-42b8-8ece-f66f82ce1a3d","subtype":"command","commandType":"auto","position":0.9443359375,"command":"-- STEP 4 Solution\n\nDESCRIBE HISTORY movies","commandVersion":20,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"3075","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":true,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"fffe6306-e6c6-4f09-acb8-c3fb260e3ce7"},{"version":"CommandV1","origId":2196225004912904,"guid":"24a22311-8696-45db-ac51-d5d3a0686250","subtype":"command","commandType":"auto","position":0.9453125,"command":"%md Let's have a look at the delta files in the file structure on the file system","commandVersion":31,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"f01fba33-2060-4b3f-93f8-bc75b729369a"},{"version":"CommandV1","origId":2196225004912905,"guid":"200cec31-d166-438a-8774-280d2e402ac8","subtype":"command","commandType":"auto","position":0.94921875,"command":"%python\n# STEP 5\n\n \n\n# dbutils.fs.ls is your friend","commandVersion":32,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"91f6503f-5571-4fb0-b610-ebd1a6b87f6b"},{"version":"CommandV1","origId":2196225004912906,"guid":"fce8a173-467b-4e31-9467-a18197624234","subtype":"command","commandType":"auto","position":0.953125,"command":"%python\n# STEP 5 Solution\n################# Change the USER ID #############\n\npath = 'dbfs:/FileStore/shared_uploads/YOUR_EMAIL_ADDRESS/disney'\ndisplay(dbutils.fs.ls(path+\"/\"))\ndisplay(dbutils.fs.ls(path+\"/_delta_log\"))","commandVersion":64,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"1414","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":true,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"7efbf8fa-91b7-451c-ba36-a1152038cd20"},{"version":"CommandV1","origId":2196225004912907,"guid":"869f5625-693f-457a-b8da-016eb1c73dbd","subtype":"command","commandType":"auto","position":0.9609375,"command":"%md \n## Now let's create some new operations on the table\n\nInsert a new line in the table with show_id = 's0'","commandVersion":38,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"8d70edd3-9e3e-452f-a7b5-310ad8e43c9d"},{"version":"CommandV1","origId":2196225004912908,"guid":"963de0e8-cdda-49ae-8ccc-7a3ec901d32f","subtype":"command","commandType":"auto","position":0.96484375,"command":"-- STEP 6 \n\nINSERT INTO movies(???) ???\nselect * from movies where show_id='s0';","commandVersion":33,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"75d9720f-807d-4fd4-8ca5-fd49788d8455"},{"version":"CommandV1","origId":2196225004912909,"guid":"6d7b7a06-9215-47b9-b748-c4bd26065186","subtype":"command","commandType":"auto","position":0.96875,"command":"-- STEP 6 Solution\n\nINSERT INTO movies(show_id, type, title, `cast`, release_year, rating, duration, listed_in) VALUES('s0', 'Movies', 'Michelin adventure', 'JG', '2022', 'PG', '120 min', '');\nSELECT * from movies where show_id='s0';","commandVersion":87,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"908","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":true,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"f0713f76-9471-47c7-82d0-12264223800f"},{"version":"CommandV1","origId":2196225004912910,"guid":"72f58266-9d0a-49c7-af7e-b3e70a0f8a28","subtype":"command","commandType":"auto","position":1.96875,"command":"%md\nUpdate the line with the show_id s0 to change the title","commandVersion":17,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"ad5bfc58-fc35-4e7b-b11a-02e51ac2e57f"},{"version":"CommandV1","origId":2196225004912911,"guid":"cf54e137-8620-4f5e-bac1-ed61c1a223f7","subtype":"command","commandType":"auto","position":2.46875,"command":"-- STEP 7 \n\nUPDATE movies set title ...","commandVersion":12,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"b15109de-f5c9-4850-84dc-2c741aeef964"},{"version":"CommandV1","origId":2196225004912912,"guid":"188dc896-1d8a-442b-9f31-82caa0d67e9c","subtype":"command","commandType":"auto","position":2.71875,"command":"-- STEP 7 SOLUTION\n\nUPDATE movies set title='We have a plan' where show_id='s0';\n\n","commandVersion":15,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"270","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":true,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"5983c0fe-5b68-4bba-b3bb-2ce7777ba5b6"},{"version":"CommandV1","origId":2196225004912913,"guid":"04af606d-7763-4ca1-be5f-d45b88283f3e","subtype":"command","commandType":"auto","position":2.84375,"command":"%md\nDelete the line with the show_id s0","commandVersion":11,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"51af01ec-4240-4e57-ad82-b1753eba2f56"},{"version":"CommandV1","origId":2196225004912914,"guid":"eebf9d53-21df-4d80-8aac-8b79bbac0e85","subtype":"command","commandType":"auto","position":2.875,"command":"-- STEP 8 \n\nDELETE FROM  ","commandVersion":6,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"958ea982-a95e-4f19-92ad-8bba8a708f75"},{"version":"CommandV1","origId":2196225004912915,"guid":"2df857e6-b060-4639-99b4-45ede9c29789","subtype":"command","commandType":"auto","position":2.90625,"command":"-- STEP 8 SOLUTION\n\nDELETE FROM  movies  where show_id='S0';","commandVersion":8,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"270","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":true,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"6aa96500-93d1-4339-8847-f48233ac2603"},{"version":"CommandV1","origId":2196225004912916,"guid":"ddb5e33c-1c40-4598-a6c6-ffc9ace34e58","subtype":"command","commandType":"auto","position":2.9375,"command":"%md\n## These operations have enriched the history\n\nRun again the cmd 11 and cmd 14 to see the history of the table and the new files created","commandVersion":76,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"552ad80c-724e-4d33-8cf8-1018e9331aa3"},{"version":"CommandV1","origId":2196225004912917,"guid":"68e1d902-a109-4dfb-9589-bb162560e521","subtype":"command","commandType":"auto","position":2.9453125,"command":"%md\n## Now let's try to query the different versions of the table\n\nNow using \"TABLE@Vx\" you can call back the version x of a table\n\nJust look at the V0, V1, V2 and V3 of the row S0","commandVersion":85,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"2c218e53-8ff4-405b-b5c0-466e7b1aafd8"},{"version":"CommandV1","origId":2196225004912918,"guid":"9c75547e-5ff0-4aca-93bf-5ac98f5be4ee","subtype":"command","commandType":"auto","position":2.94921875,"command":"-- STEP 9\n\nselect * from ??? where show_id='s0'","commandVersion":19,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"c8bc193e-4604-4187-8f33-348e51f1eec5"},{"version":"CommandV1","origId":2196225004912919,"guid":"2b2b450d-2f8d-4cbd-888f-0f6d2973df8b","subtype":"command","commandType":"auto","position":2.953125,"command":"-- STEP 9 SOLUTION\n\nSELECT * from movies@v2 where show_id='s0'","commandVersion":7,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"908","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":true,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"9f1879c5-d02e-477b-95c4-1759a47fd01d"}],"dashboards":[],"guid":"b2367dfa-fc05-4a71-a0fa-6b8395dca224","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":2}}