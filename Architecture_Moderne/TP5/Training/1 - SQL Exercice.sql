{"version":"NotebookV1","origId":2196225004912833,"name":"1 - SQL Exercice","language":"sql","commands":[{"version":"CommandV1","origId":2196225004912834,"guid":"f6c92c7a-08e7-489c-ba63-610171ebe8fd","subtype":"command","commandType":"auto","position":0.0625,"command":"%md\n## SQL the Ubiquitous language for data analysts\n\nBefore doing some SQL, let's look for a datasource\n\n%fs provides utilities for working with FileSystems\n\nADLS Path : \ndbfs:/FileStore/shared_uploads/YOUR_EMAIL_ADDRESS/disney_plus_titles.csv\n\n","commandVersion":39,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"7861b494-a77b-4d6a-8209-e3aa0e7c2250"},{"version":"CommandV1","origId":2196225004912835,"guid":"f0e57c23-fd26-45d3-8804-bac4d0929fde","subtype":"command","commandType":"auto","position":0.125,"command":"%fs\n\nls ???\n","commandVersion":210,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"828","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"8354f7c1-fad1-4942-b605-83e7a0637d29"},{"version":"CommandV1","origId":2196225004912836,"guid":"45650e4e-b704-4465-ae54-0da85648d1a2","subtype":"command","commandType":"auto","position":0.1875,"command":"%fs\n\nls dbfs:/FileStore/shared_uploads/YOUR_EMAIL_ADDRESS/disney_plus_titles.csv","commandVersion":84,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"828","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":true,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"f7797b08-8ab5-4b2c-9113-21e55e89a6ef"},{"version":"CommandV1","origId":2196225004912837,"guid":"5d65fa1e-a7db-40b3-9d06-4bd90e3d20cb","subtype":"command","commandType":"auto","position":0.21875,"command":"%md\n## SQL is possible directly on a CSV file\n\nMake a SQL request on the CSV file using :\nselect * from csv.\\`PATH\\`\n","commandVersion":89,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"8f8209dd-942d-4067-8aa2-9fd4b76b8ef7"},{"version":"CommandV1","origId":2196225004912838,"guid":"20ee9ea0-0a79-4762-bd1a-5b3f0542ee22","subtype":"command","commandType":"auto","position":0.25,"command":"-- STEP 2\n\nselect * from csv.`???`;","commandVersion":25,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"4289","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"42645983-cbf9-47b4-ab28-cb02b3d1b23f"},{"version":"CommandV1","origId":2196225004912839,"guid":"0a474f5d-d1ad-4204-beb0-79e6e4ad25c5","subtype":"command","commandType":"auto","position":0.28125,"command":"-- STEP 2 SOLUTION\n\nselect * from csv.`dbfs:/FileStore/shared_uploads/YOUR_EMAIL_ADDRESS/disney_plus_titles.csv`;\n","commandVersion":42,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"4274","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":true,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"e6ee8d79-f600-42ad-9680-fce2a5197d02"},{"version":"CommandV1","origId":2196225004912840,"guid":"d49fd703-e3fc-49bf-8a20-f27ccc0f95cb","subtype":"command","commandType":"auto","position":0.3125,"command":"%md \n\nYou can see that the headers are in the result ... let's correct that by creating a temporary table\n\n## A CSV file can be loaded into a temporary table","commandVersion":38,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"3f269689-ce20-4646-a0e0-acd5fc7cf3d4"},{"version":"CommandV1","origId":2196225004912841,"guid":"b440f512-2c7c-46cb-bfc7-37882e69f626","subtype":"command","commandType":"auto","position":0.328125,"command":"-- STEP 3 \n\nCREATE TEMPORARY TABLE DisneyMovies\n    USING csv\n    OPTIONS (\n      path \"<PATH>\",\n      delimiter \",\",\n      header \"true\"\n    );","commandVersion":14,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"54c2ac0c-94c0-407e-85ea-cc5bd277818a"},{"version":"CommandV1","origId":2196225004912842,"guid":"309b47b0-4d23-4917-9e68-e4883e13bea9","subtype":"command","commandType":"auto","position":0.34375,"command":"-- STEP 3 SOLUTION\n\nDROP TABLE if exists DisneyMovies;\n\nCREATE TEMPORARY TABLE DisneyMovies\n    USING csv\n    OPTIONS (\n      path \"dbfs:/FileStore/shared_uploads/YOUR_EMAIL_ADDRESS/disney_plus_titles.csv\",\n      delimiter \",\",\n      header \"true\"\n    );","commandVersion":35,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":true,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"0f3f4bc0-cc7d-41d8-af34-6d3fbf6a8b02"},{"version":"CommandV1","origId":2196225004912843,"guid":"9ee52bee-8c2d-42e2-a2c1-61eb39c0fe35","subtype":"command","commandType":"auto","position":0.40625,"command":"%md Describe the Table to see the different columns and type","commandVersion":18,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"2495d675-b6d7-457d-9983-8f5864c3928e"},{"version":"CommandV1","origId":2196225004912844,"guid":"d94ff000-0faa-4c5f-9b2a-44a55d5a6838","subtype":"command","commandType":"auto","position":0.421875,"command":"-- STEP 4 \n\n-- CODE HERE","commandVersion":7,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"8e488670-831b-4eb6-bc8b-e63cbd9381b2"},{"version":"CommandV1","origId":2196225004912845,"guid":"2ed7e442-c7f4-47ad-8e95-0c245f93cb19","subtype":"command","commandType":"auto","position":0.4375,"command":"-- STEP 4 SOLUTION\n\nDESCRIBE disneymovies","commandVersion":14,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"369","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":true,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"2616a729-2a91-4bff-a90c-0c36531e26bb"},{"version":"CommandV1","origId":2196225004912846,"guid":"06f0424f-2b24-4359-af8a-043f012648dd","subtype":"command","commandType":"auto","position":1.125,"command":"%md Show all movies with the title containing frozen","commandVersion":14,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"dbc2e6ee-1d86-47be-a40f-3ba28e593131"},{"version":"CommandV1","origId":2196225004912847,"guid":"f1d5aace-244e-4e11-8ef9-88870e12ccc1","subtype":"command","commandType":"auto","position":1.1875,"command":"-- STEP 5 \n\n-- CODE HERE\n???","commandVersion":8,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"c2f914aa-efeb-49ed-9858-e81762db9d89"},{"version":"CommandV1","origId":2196225004912848,"guid":"a943609b-a7c1-44c5-8f81-d520eaf355a2","subtype":"command","commandType":"auto","position":1.25,"command":"-- STEP 5 SOLUTION\n\n--select * FROM disneymovies;\n--select * from disneymovies where title='Frozen'\nselect * from disneymovies where lower(title) like '%frozen%'","commandVersion":39,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"4274","height":"322","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":true,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"38712a55-1b94-4145-9459-8c23d14de305"},{"version":"CommandV1","origId":2196225004912849,"guid":"d947fcf7-2ca8-41a0-9b0b-3ea19f7f3266","subtype":"command","commandType":"auto","position":1.375,"command":"%md \n\n## It is also possible to create graph to visualize the data\n\nRating shows the public that can look at the movies.\n\nBuild a graph to see the number of movies by rating","commandVersion":74,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"0b81811c-768c-42d1-ae6b-f9ab247fce04"},{"version":"CommandV1","origId":2196225004912850,"guid":"5159eb1a-b51c-41a0-8003-aa0030c96fe5","subtype":"command","commandType":"auto","position":1.4375,"command":"-- STEP 6 \n\n-- CODE HERE","commandVersion":6,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"14a2a7e0-60d1-4db1-99f5-39e2755fcdbe"},{"version":"CommandV1","origId":2196225004912851,"guid":"865a84bd-9de9-44e1-ba31-ed4facc894a1","subtype":"command","commandType":"auto","position":1.5,"command":"-- STEP 6 SOLUTION\n\nselect distinct rating from disneymovies \nwhere rating is not null and rating <>'United States' and rating not like 'Decembe%' and rating not like '%Todd%';\n\nselect rating, count(*) as c from disneymovies \nwhere rating is not null and rating <>'United States' and rating not like 'Decembe%' and rating not like '%Todd%'\ngroup by rating order by c desc;","commandVersion":117,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"pieChart","width":"270","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":true,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"nuid":"90f63d76-20c6-4f97-bafb-460d88d656af"}],"dashboards":[],"guid":"b92d6711-0f28-4e65-b162-9bb26d2a70a7","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":2}}